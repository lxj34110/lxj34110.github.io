eval(function(p,a,c,k,e,r){e=function(c){return(c<62?'':e(parseInt(c/62)))+((c=c%62)>35?String.fromCharCode(c+29):c.toString(36))};if('0'.replace(0,e)==0){while(c--)r[e(c)]=k[c];k=[function(e){return r[e]||e}];e=function(){return'([3-9bfhjkpqv-zA-Z]|1\\w)'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('5.x("DOMContentLoaded",()=>{7 e=5.G("fileInput");9 g=5.G("bookList");5.G("addToBookshelf");N n=v 10,s;7 t=I.J("bookMetadataDB",1);8 r(){g.innerHTML="",n.h((o,e)=>{7 t=5.y("O"),n=(t.z="w-card",5.y("input")),n=(n.P="K",n.z="A-K",n.Q.R=o.4,n.x("L",e=>{e.stopPropagation()}),t.B(n),5.y("11")),r=(n.src="../11/w-banner.jpg",n.alt="书籍封面",n.z="w-cover",5.y("O")),a=(r.z="w-info",5.y("O")),c=(a.z="w-title",a.S=o.4,5.y("label")),d=(c.z="w-date",v Date(o.T)),s=d.getFullYear().H(),l=d.getMonth()+1,i=d.getDate(),m=d.getHours().H().U(2,"0"),u=d.getMinutes().H().U(2,"0"),d=d.getSeconds().H().U(2,"0");c.S=`☪${s}/${l}/${i}${m}:${u}:`+d,r.B(a),r.B(c),t.B(n),t.B(r),t.Q.index=e,t.x("L",12()=>{7 e=I.J("V",1);e.j=8(e){9 t=e.3.b.C(["k"],"13").D("k").get(E(o.4));t.j=8(){7 e=t.b?.14;f.W("查询的键:",E(o.4)),f.W("查询结果:",t.b),e?((e=v URL("txt-reader/page/w-detail.html",15.16.origin)).searchParams.set("R",E(o.4)),15.16.href=e.H()):alert(`书籍内容不存在，请重新添加！查询的键:`+E(o.4))}},e.F=8(e){f.6("17错误:",e.3.6)}}),g.B(t)})}t.18=8(e){(s=e.3.b).19.1a("p")||s.1b("p",{1c:"4"})},t.j=8(e){9 t=(s=e.3.b).C(["p"],"13").D("p").getAll();t.j=8(){7 e=t.b||[];n=v 10(e),r()}},t.F=8(e){f.6("元数据数据库错误:",e.3.6)},e.x("change",e=>{X.Y(e.3.files).h(12 o=>{7 e;[...n].some(e=>e.4===o.4)||((e=v FileReader).onload=8(e){9 t=e.3.b;e=I.J("V",1);e.18=8(e){e=e.3.b;e.19.1a("k")||e.1b("k",{1c:"4"})},e.j=8(e){e=e.3.b.C(["k"],"M");e.D("k").1d({4:E(o.4),14:t}),e.oncomplete=8(){if(n.add({4:o.4,T:o.T,1e:o.1e,P:o.P}),s){9 t=s.C(["p"],"M").D("p");X.Y(n).h(e=>{t.1d(e)})}r()}},e.F=8(e){f.6("17错误:",e.3.6)}},e.readAsText(o))})}),r();9 o=5.G("allSelected");o.x("L",()=>{7 e=5.1f(".A-K");9 t=[...e].every(e=>e.Z);e.h(e=>e.Z=!t),o.S=t?"批量全选":"取消全选"}),5.G("deleteSelected").x("L",()=>{7 d,e=5.1f(".A-K:Z");9 t=X.Y(e).map(e=>e.Q.R);t.h(t=>{n.h(e=>{e.4===t&&n.A(e)})}),s?(d=t,v 1g((o,n)=>{9 r=s.C(["p"],"M").D("p");N a=0,c=[];d.h(t=>{7 e=r.A(t);e.j=()=>{++a===d.q&&(0<c.q?n(c):o())},e.F=e=>{f.6("删除书籍元数据失败: "+t,e.3.6),c.1h(e.3.6),++a===d.q&&n(c)}}),0===d.q&&o()}).1i(()=>{return d=t,v 1g((a,c)=>{7 e=I.J("V",1);e.F=e=>{c(e.3.6)},e.j=e=>{9 o=e.3.b.C(["k"],"M").D("k");N n=0,r=[];d.h(t=>{7 e=E(t),e=o.A(e);e.j=()=>{++n===d.q&&(0<r.q?c(r):a())},e.F=e=>{f.6("删除书籍内容失败: "+t,e.3.6),r.1h(e.3.6),++n===d.q&&c(r)}}),0===d.q&&a()}});7 d}).1i(()=>{f.W("所有选中的书籍已成功删除"),r()}).catch(e=>{f.6("删除书籍时出错:",e),r()})):r()})});',[],81,'|||target|name|document|error|var|function|const||result||||console||forEach||onsuccess|books|||||bookMetadata|length|||||new|book|addEventListener|createElement|className|delete|appendChild|transaction|objectStore|encodeURIComponent|onerror|getElementById|toString|indexedDB|open|checkbox|click|readwrite|let|div|type|dataset|bookName|textContent|lastModified|padStart|bookDB|log|Array|from|checked|Set|img|async|readonly|content|window|location|IndexedDB|onupgradeneeded|objectStoreNames|contains|createObjectStore|keyPath|put|size|querySelectorAll|Promise|push|then'.split('|'),0,{}))
