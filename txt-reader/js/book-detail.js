eval(function(p,a,c,k,e,r){e=function(c){return(c<62?'':e(parseInt(c/62)))+((c=c%62)>35?String.fromCharCode(c+29):c.toString(36))};if('0'.replace(0,e)==0){while(c--)r[e(c)]=k[c];k=[function(e){return r[e]||e}];e=function(){return'([479b-dfhj-mo-rt-yA-Z]|[1-3]\\w)'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('y j;y o;y 7;y f=0;y k=[];y x=\'\';y 1z=\'\';d 12(r){13(r);7.t=k[r].7;14(r);7.m=0;1S(r,0)}d 1S(p,m){9(j&&x){4 c=j.c([\'G\'],\'1A\');4 q=c.L(\'G\');q.1B({x:1z,15:{p:p,m:m}})}}b.u(\'DOMContentLoaded\',()=>{4 2m=b.h(\'2m\');o=b.h(\'o\');7=b.h(\'7\');4 16=b.1T(\'M\');16.id=\'16\';16.v.cssText=`15:absolute;left:0;top:0;width:5px;background-color:#007bff;1U:0%;transition:1U 0.1s ease;z-r:1V;`;7.2n.v.15=\'relative\';7.2n.1W(16);7.u(\'2o\',()=>{4 m=7.m;4 1g=7.1g-7.2p;9(1g===0)1C;4 2q=(m/1g)*1V;16.v.1U=`${2q}%`});4 17=b.h(\'V\');4 18=b.h(\'W\');4 19=b.h(\'1a\');4 1X=b.h(\'1X\');1X.u(\'C\',()=>{4 l=b.2r(\'.l\');l.v.D=l.v.D===\'N\'?\'2s\':\'N\'});4 1D=2t.2u(\'userSettingsDB\',1);1D.onupgradeneeded=d(A){j=A.1h.P;9(!j.2v.1Y(\'H\')){j.2w(\'H\',{2x:\'id\'})}9(!j.2v.1Y(\'G\')){j.2w(\'G\',{2x:\'x\'})}};d 2y(){4 c=j.c([\'H\'],\'1i\');4 q=c.L(\'H\');4 w=q.1b(\'1E\');w.X=d(){4 1j=w.P?.l||{};17.B=1j.V||\'1.6\';18.B=1j.W||\'1.125rem\';19.B=1j.1a||\'light\';1k(1j)}}1D.X=d(A){j=A.1h.P;2y()}1D.2z=d(A){1l.Q(\'用户设置数据库错误:\',A.1h.Q)};17.u(\'1Z\',()=>{4 l={V:17.B,W:18.B,1a:19.B};1k(l);9(j){4 c=j.c([\'H\'],\'1A\');4 q=c.L(\'H\');q.1B({id:\'1E\',l:l})}});18.u(\'1Z\',()=>{4 l={V:17.B,W:18.B,1a:19.B};1k(l);9(j){4 c=j.c([\'H\'],\'1A\');4 q=c.L(\'H\');q.1B({id:\'1E\',l:l})}});19.u(\'1Z\',()=>{4 l={V:17.B,W:18.B,1a:19.B};1k(l);9(j){4 c=j.c([\'H\'],\'1A\');4 q=c.L(\'H\');q.1B({id:\'1E\',l:l})}});d 1k(l){7.v.V=l.V;7.v.W=l.W;b.20.className=l.1a}4 2A=1F URLSearchParams(1G.location.search);x=decodeURIComponent(2A.1b(\'x\'));1z=1H(x);4 21=b.h(\'txtTitle\');9(21){21.t=x.Y(".1m","")||\'1m在线阅读工具\'}4 1I=b.h(\'toggleChapters\');9(1I){1I.u(\'C\',()=>{4 o=b.h(\'o\');9(o){4 1J=o.v.D===\'N\';o.v.D=1J?\'1K\':\'N\';1I.t=1J?\'▥\':\'▤\';9(1J){4 22=o.2r(\'.1n\');9(22){22.scrollIntoView({behavior:\'smooth\',1K:\'nearest\'})}}}})}b.h(\'prevChapter\').u(\'C\',()=>{9(f>0){f--;12(f)}});b.h(\'nextChapter\').u(\'C\',()=>{9(f<k.R-1){f++;12(f)}});y 23=\'\';4 S=b.h(\'editChapter\');4 2B=b.h(\'saveChapterEdit\');4 2C=b.h(\'cancelChapterEdit\');4 1o=b.h(\'1o\');4 1p=b.h(\'1p\');4 E=b.h(\'7\');S.u(\'C\',()=>{23=E.t;E.24=\'1q\';E.T.1L(\'25\');1o.v.D=\'1K\';1p.v.D=\'1K\';E.focus();S.t=\'✍\';S.26=1q});2C.u(\'C\',()=>{E.t=23;E.24=\'1r\';E.T.27(\'25\');1o.v.D=\'N\';1p.v.D=\'N\';S.t=\'✎\';S.26=1r});2B.u(\'C\',()=>{k[f].7=E.t;14(f);E.24=\'1r\';E.T.27(\'25\');1o.v.D=\'N\';1p.v.D=\'N\';S.t=\'✎\'S.26=1r;2D()});async d 2D(){4 2E=b.h(\'7\');y 7=2E.innerText;7=7.Y(/<br\\s*\\/?>/gi,\'\\n\').Y(/<M>/gi,\'\\n\').Y(/<\\/M>/gi,\'\');7=7.Y(/<[^>]*>/g,\'\').2F();9(!7){1t(\'无法保存空内容，请确保章节有文字内容后重试\');1C}4 2G=k[f].1M;4 2H=2G.Y(/[\\\\/:*?"<>|]/g, \'\');\n        4 Z = 1F Date();\n        4 2I = `${Z.getFullYear()}${1u(Z.getMonth() + 1).1v(2, \'0\')}${1u(Z.getDate()).1v(2, \'0\')}_${1u(Z.getHours()).1v(2, \'0\')}${1u(Z.getMinutes()).1v(2, \'0\')}${1u(Z.getSeconds()).1v(2, \'0\')}`;\n        4 I = `${2H}+${2I}.1m`;\n        2J {\n            // 尝试使用文件系统API保存文件\n            9 (1G.2K) {\n                4 2L = 1N 1G.2K({\n                    suggestedName: I,\n                    types: [{\n                        description: \'Text Files\',\n                        accept: {\'O/2M\': [\'.1m\']},\n                    }],\n                });\n                4 29 = 1N 2L.createWritable();\n                1N 29.write(7);\n                1N 29.close();\n                2a(I, 1q);\n            } 1c {\n                // 传统下载方式\n                4 2N = 1F Blob([7], { type: \'O/2M;charset=utf-8\' });\n                4 2b = 2O.createObjectURL(2N);\n                4 a = b.1T(\'a\');\n                a.href = 2b;\n                a.download = I;\n                b.20.1W(a);\n                // 使用合成鼠标事件提高移动端兼容性\n                4 A = 1F MouseEvent(\'C\', {\n                    view: 1G,\n                    bubbles: 1q,\n                    cancelable: 1q\n                });\n                a.dispatchEvent(A);\n                // 延长延迟至5秒，确保低速移动设备完成下载\n                2c(() => {\n                    b.20.removeChild(a);\n                    2O.revokeObjectURL(2b);\n                }, 5000);\n                2a(I, 1r);\n            }\n        } 2P (Q) {\n            1l.Q(\'文件保存失败:\', Q);\n            1t(`文件保存失败: ${Q.1w}\\n\\n请尝试以下解决方法:\\n1. 检查浏览器存储权限\\n2. 确保手机存储空间充足\\n3. 手动创建/1m文件夹后重试\\n4. 确认章节内容不为空`);\n        }\n    }\n    d 2a(I, 2Q) {\n        4 2R = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n        9 (2R) {\n            y 1w;\n            9 (2Q) {\n                1w = `章节内容已保存至:\n${I}\n提示: 文件已保存到您选择的位置\n您可以通过文件管理器查找此文件`;\n            } 1c {\n                1w = `下载已启动，请检查默认下载文件夹:\n${I}\n提示: 传统下载方式无法确认保存状态，请确保:\n1. 浏览器允许来自此网站的下载\n2. 手机存储空间充足\n3. 查看浏览器默认下载路径\n故障排除:\n• 检查浏览器的"下载历史"页面\n• 在文件管理器中搜索"${I}"•确认浏览器弹出窗口阻止设置未阻止下载•尝试使用2S浏览器获得更好兼容性`}1t(1w)}1c{1t(`章节内容已保存至默认下载文件夹:${I}提示:现代浏览器支持选择保存位置，请使用2S、Edge或Firefox最新版本以获得更好体验。`)}}4 1O=b.h(\'1O\');4 1P=b.h(\'1P\');9(1O&&1P){1O.u(\'C\',()=>{9(f>0){f--;12(f)}});1P.u(\'C\',()=>{9(f<k.R-1){f++;12(f)}})}9(x){4 2d=2t.2u(\'bookDB\',1);2d.X=d(A){4 db=A.1h.P;4 c=db.c([\'2U\'],\'1i\');4 q=c.L(\'2U\');4 w=q.1b(1H(x));w.X=d(){4 11=w.P?.7;1l.2V(\'x:\',x);1l.2V(\'11:\',11?\'存在\':\'不存在\');9(11){4 k=2e(11);2f(k);2g(k);9(j){4 c=j.c([\'G\'],\'1i\');4 q=c.L(\'G\');4 w=q.1b(1H(x));w.X=d(){4 J=w.P?.15;9(J){4{p,m}=J;13(p);7.t=k[p].7;7.m=m;14(p);4 F=o.1x(\'M\');9(F[p]){o.m=F[p].2h-2i}}}}}1c{1t(\'书籍内容不存在，请重新添加！\');7.t=\'书籍内容不存在，请返回书架重新添加！\'}}};2d.2z=d(A){1l.Q(\'获取文件内容失败:\',A.1h.Q)};d renderBookContent(11){4 k=2e(11);2f(k);2g(k);9(j){4 c=j.c([\'G\'],\'1i\');4 q=c.L(\'G\');4 w=q.1b(1H(x));w.X=d(){4 J=w.P?.15;9(J){4{p,m}=J;13(p);7.t=k[p].7;7.m=m;4 F=o.1x(\'M.1y-U\');9(F[p]){o.m=F[p].2h-2i}}}}}}});d 2e(O){4 2W=/^[\\s#*$]*(第)?[零一二三四五六七八九十百千1234567890]+章.*$/gm;4 K=[];y 1d;y 1Q=0;while((1d=2W.exec(O))!==null){9(K.R>0){K[K.R-1].7=O.2X(1Q,1d.r)}K.2Y({1M:1d[0],startIndex:1d.r,7:\'\'});1Q=1d.r}9(K.R>0){K[K.R-1].7=O.2X(1Q)}1c{K.2Y({1M:\'章节识别失败\',7:O})}1C K}d 2f(2Z){k=2Z;o.innerHTML=\'\';9(j){d 2j(){2J{4 c=j.c([\'G\'],\'1i\');4 q=c.L(\'G\');4 w=q.1b(1z);w.X=d(){4 J=w.P?.15;9(J){f=J.p;13(f);7.t=k[f].7;7.m=J.m||0;14(f);4 F=o.1x(\'M\');9(F[f]){o.m=F[f].2h-2i}}}}2P(e){2c(2j,1V)}}2j()}k.30((1y,r)=>{4 1e=b.1T(\'M\');1e.t=1y.1M;1e.T.1L(\'1y-U\');9(r===f){1e.T.1L(\'1n\')}1e.u(\'C\',()=>{f=r;12(r)});o.1W(1e)})}d 2g(k){9(k.R>0){7.t=k[0].7;13(0);14(0)}7.u(\'2o\',31(()=>{4 p=Array.from(o.1x(\'M\')).findIndex(U=>U.T.1Y(\'1n\'));9(p!==-1){1S(p,7.m)}4 32=7.m+7.2p>=7.1g-10;4 1R=b.h(\'1R\');9(1R){1R.v.D=32?\'2s\':\'N\'}},300))}d 31(33,34){y 2k;1C d(){4 35=this;4 36=arguments;clearTimeout(2k);2k=2c(()=>{33.apply(35,36)},34)}}d 13(r){4 F=o.1x(\'M.1y-U\');F.30((U,i)=>{9(i===r){U.T.1L(\'1n\')}1c{U.T.27(\'1n\')}})}d 14(r){4 O=k[r].7.2F();4 37=O.Y(/\\s+/g,\'\').R;4 2l=b.h(\'chapterWordCount\');9(2l){2l.t=`字数:${37}`}}',[],194,'||||const|||content||if||document|transaction|function||currentChapterIndex||getElementById||settingsDB|chapters|settings|scrollTop||chapterList|chapterIndex|store|index||textContent|addEventListener|style|getRequest|bookName|let||event|value|click|display|contentDiv|chapterItems|readingPositions|readingSettings|fileName|savedPosition|matches|objectStore|div|none|text|result|error|length|editButton|classList|item|lineHeight|fontSize|onsuccess|replace|now||fileContent|updateChapter|highlightChapter|updateWordCount|position|progressBar|lineHeightSelect|fontSizeSelect|themeSelect|theme|get|else|match|chapterDiv||scrollHeight|target|readonly|savedSettings|applySettings|console|txt|active|editControls|editStatus|true|false||alert|String|padStart|message|querySelectorAll|chapter|encodedBookName|readwrite|put|return|settingsDBRequest|globalSettings|new|window|encodeURIComponent|toggleBtn|isHidden|block|add|title|await|prevChapterBottom|nextChapterBottom|lastIndex|chapterButtons|saveReadingPosition|createElement|height|100|appendChild|settingsToggle|contains|change|body|h1Element|activeChapter|originalContent|contentEditable|editing|disabled|remove||writable|showSaveNotification|url|setTimeout|dbRequest|parseChapters|renderChapters|renderContent|offsetTop|200|readReadingPosition|timeout|wordCountElement|fileInput|parentNode|scroll|clientHeight|percentage|querySelector|flex|indexedDB|open|objectStoreNames|createObjectStore|keyPath|initSettings|onerror|urlParams|saveButton|cancelButton|saveChapterAsTxt|contentElement|trim|chapterTitle|cleanTitle|dateTime|try|showSaveFilePicker|handle|plain|blob|URL|catch|usedFileSystemAPI|isMobile|Chrome||books|log|chapterRegex|slice|push|chaptersData|forEach|debounce|isAtBottom|func|wait|context|args|wordCount'.split('|'),0,{}))
